<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="dashboard.css">
    <title>Dashboard</title>
    <style>  
      @import url('https://fonts.googleapis.com/css2?family=Dela+Gothic+One&display=swap');
      @import url('https://fonts.googleapis.com/css2?family=Delius&display=swap');
    </style>
</head>
<body>
    <div class="headnav">
        <h1 class="icon">II BSIT A</h1>
    </div>
      <div class="container">
     <h1 class="dashboard-title">Dashboard</h1>
        <p class="dashboard-description">Welcome to your dashboard! Here you can manage your movies, view ratings, and more.</p>
      </div> 
    <div class="search-box">
        <input type="text" id="search" placeholder="Search movies..." class="search-input">
         <button type="submit" class="addbtn" onclick="addtoggle()">add</button>    
         <button type="submit" class="retrievebtn">Retrieve</button>                   
    </div>
    <div class="table-container">
      <h2>Movie List</h2>
    </div>
    <div id="popup">
      <h1 class="addtxt">Add</h1>
        <span>Title:</span>
      <input type="text" id="title" placeholder="Movie Title" class="input-field">
       <span>Director"</span>
      <input type="text" id="director" placeholder="Director" class="input-field">
       <span>Release year:</span>
      <input type="text" id="release_year" placeholder="Release year" class="input-field">
       <span>Ratings:</span>
      <input type="text" id="rating" placeholder="Ratings" class="input-field">
      <div class="btn">
       <button onclick="addtoggle2();" class="btnclose">close</button>
       <button onclick="createMovies();" class="btnadd">add</button>
    </div>
      </div>
      <div class="crud">
    <table id="moviesTable">
  <thead>
    <tr>
      <th>Title</th>
      <th>Director</th>
      <th>Release Year</th>
      <th>Rating</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <!-- JS will insert new movie rows here -->
  </tbody>
</table>

      </div>
    <script> 
     function addtoggle(){
     
        var popup = document.getElementById('popup');
        popup.classList.toggle('active');}
     function addtoggle2(){
     
        var popup = document.getElementById('popup');
        popup.classList.toggle('active');}   

       function createMovies() {
            const title = document.getElementById("title").value;
            const director = document.getElementById("director").value;
            const release_year = document.getElementById("release_year").value;
            const rating = document.getElementById("rating").value;

            if (!title) {
                alert("Please input Movie Title");
                return;
            }

            const Movies = {
                title: title,
                director: director || " ",
                release_year: release_year || " ",
                rating: rating || " ",

            };

            console.log(JSON.stringify(Movies));

            fetch("http://localhost:3000/addMovies", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(Movies),
            })

                .then((response) => {
                    if (!response.ok) {
                        throw new Error("Network response was not OK");
                    }

                    return response.json();
                })


                .then((data) => {
                    alert("Movie added sucessfully!");

                    document.getElementById("title").value = "";
                    document.getElementById("director").value = "";
                    document.getElementById("release_year").value = "";
                    document.getElementById("rating").value = "";
                    
                })

                .catch((error) => {
                    console.error("Error:", error);
                    alert("Error creating student. Please try again.");
                });
        }

    </script>
</body>
</html>